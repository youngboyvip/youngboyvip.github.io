## 基础流程

#### 报错流程

**自动检测**
检测设备的数值，自动报错给负责人，负责人处理后由巡查人员确认是否修好

**定期检测（是否允许重复报错？）**
人工巡查扫描二维码记录巡查记录，发现损坏的设备后巡查人员扫描二维码后app弹出设备的详情页面，详情页面上有设备报错按钮，点击按钮跳到对应的表单页面填写表单上报给设备负责人

**负责人报错**
负责人接到任务后，到达现场app扫描设备的二维码弹出设备详情，设备详情页面包含异常记录，和相对应的任务，点击某个任务进入表单填写页面选择故障设备部件名称，选择故障原因，选择处理的方式，如果选择的是报废处理就需要显示相关配件的库存，如果库存不够负责人需要发起申请采购流程等待采购流程完成，如果库存足够需要去仓库领取相关配件，仓库人员需要发起出库流程开取相关单据审批后才允许配件出库，设备修好后由巡查人员确认是否修好

**巡检人员复检**
巡检人员检查设备是否修好

#### 申请采购流程
物料需求部门（负责人）在新品申购上发起物料采购流程
采购人员根据`《物料采购申请单》`进行采购
采购完物品后需向供应单位索取正规单具（名称、数量、金额，签字或盖章）

#### 入库流程
采购人员采购完毕后，需将采购物品交仓库进行入库，仓库人员对采购物品验收后进行入库并开具`《入库单》`

#### 出库流程
仓库人员填写出库单，交给相关负责人审批，审批后出库

#### 报销流程
采购人员持采购前审批的《物料采购申请单》，仓库开具的《入库单》和供应单位所开单具，到财务处申请报销，财务人员应认真核对数量及金额，并填写`领款凭证`
送交总经理签字审批后，才能予以报销。

#### 经费申请流程
填写经费申请单->领导审批->财务部门审批->总经理审批->出纳处领款

#### 检修计划审批流程
发起人填写检修计划表单，相关负责人审批后发布


## Activiti BPM平台
- 宏天EIP [http://www.hotent.xyz:8093/login](http://www.hotent.xyz:8093/login)
- 红讯 [http://www.redxun.cn:8020/saweb/login.jsp   admin  1](http://www.redxun.cn:8020/saweb/login.jsp)
- agilebpm（开源） [http://test.agilebpm.cn/login.html admin 1](http://test.agilebpm.cn/login.html)

宏天EIP各个流程功能比较齐全，表单设计部分是拖拽式的设计，支持pc端表单和手机端表单，前台为anaglar单应用网页

红讯平台表单设计器使用富文本编辑器实现，支持pc端表单和手机端表单，流程设计操作有些复杂

agilebpm 功能与宏天EIP有部分类似，功能还算齐全，流程设计器UI做的比较粗糙，表单设计器使用富文本编辑器实现，支持pc端表单和手机端表单

平台 | 权限转移|流程干预|沟通与抄送|流程授权|表单字段授权|任务转办|任务代理
--|--|--|--|--|--|--|--|--
宏天EIP|有|有|有|有|有|有|有
红讯|无|有|有|有|有|有|有
agilebpm|无|有|无|有|有|无|无

## 目标
简洁的配置流程和表单，有效的流程监控和干预，快速实现业务流程

## 主要功能模块
- 组织架构模块
- 业务建模模块
- 表单模块
- 流程模块

### 组织架构模块
提供组织架构信息

### 业务建模模块
提供业务数据保存、更新、表定义、业务对象定义、表字段控件定义等功能

### 表单模块
提供表单的生成、表单高级控件的配置、表单对于业务数据增删改查的实现

### 流程模块
拓展activiti的功能

## 主要功能实现
- 流程监控
    - 流程干预
    - 权限转移
    - 流转过程
- 流程应用
    - 同意
    - 驳回
    - 沟通
    - 保存
    - 终止
    - 抄送
    - 反对
    - 转办
    - 流转
    - 打印
    - 撤回
    - 延期
    - 流程授权
    - 表单字段授权
- 业务建模
    - 实体管理
    - 业务对象
    - 生成物理表
    - 外部表映射
- 流程视图
    - 发起流程
    - 代表任务
    - 已办任务
    - 办结流程
    - 转办代理
    - 代办预警
    - 沟通与抄送



## 一般使用流程

业务建模 ---> 设计表单 ---> 设计流程 ---> 配置流程 -
---> 发布流程 ---> 使用流程

## 重点功能
### 业务建模
#### 业务实体
业务实体对应数据库中的表或数据，用户可以选择生成物理表或以json格式存在数据库中
#### 业务对象
业务实体可能会关联其他表，所以业务对象是用来管理业务实体之间的关系的对象，设计表单时会用到业务对象

### 表单设计器
#### 表单模板
生成表单的模板使用freemark或其他模板引擎实现

#### 自定义对话框配置
表单处理过程中与用户交互的对话框，如选择职务或选择用户等功能

#### 表单设计
使用富文本编辑器输出内容为html，有些平台可以拖拽生成表单输出的数据为json

### 流程设计器
拖拽生成流程，配置流程


## 可配置项
> 脚本均为Groovy脚本

### 组织结构配置
提供接口整合自己系统的组织架构

### 流程权限控制
把流程授权给指定的用户或组，只有授权的用户才可以启动流程

### 常用脚本配置
脚本可以访问spring容器中的对象或引用静态类的方法，同时也可以访问流程变量

### 流程配置项
#### 表单配置
- 全局表单
    - 手机表单
    - pc表单
- 局部表单
    - 手机表单
    - pc表单

#### 表单字段授权
指定表单中字段的修改(w)和只读(r)权限

#### 表单处理按钮配置
流程处理过程中显示的按钮，可以在流程设计的时候定义，按钮的属性和动作由后台配置

#### 流程节点事件配置（使用Groovy脚本配置）
- 前置事件
- 后置事件

#### 开始结束节点事件配置（使用Groovy脚本配置）
- 开始事件
- 结束时间
- 人工终止事件

#### 流程节点跳转规则配置
- 手动选择某一个节点
- 使用脚本选择

#### 人员配置
- 手动选择组织结构的一个维度
- 通过脚本配置
- 流程历史审批人
- 系统节点执行人

#### 节点类型配置（单实例或多实例）

#### 流程通知配置
流程结束开始或有任务时通知用户，有多种通知方式配置